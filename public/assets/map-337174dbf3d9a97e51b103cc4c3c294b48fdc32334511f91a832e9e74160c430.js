function initMap(){map=new google.maps.Map(document.getElementById("map"),{center:{lat:42.366719,lng:-71.258604},zoom:16}),createSidebar(json_array),map.data.addGeoJson(geojsonData),map.data.setStyle(function(e){var n=e.getProperty("color");return{fillColor:n,strokeColor:n,strokeWeight:2}}),map.data.addListener("mouseover",function(e){map.data.revertStyle(),map.data.overrideStyle(e.feature,{strokeWeight:5})}),map.data.addListener("mouseout",function(){map.data.revertStyle()}),map.data.addListener("click",function(e){for(var n,a=e.feature.getProperty("name"),t=0;t<json_array.length;t++){var o=json_array[t].name;a===o&&(n=json_array[t])}var r=createInfowindow(n);r.setPosition(e.latLng),r.open(map)})}function createInfowindow(e){var n="<h4>"+e.name+"</h4><p>"+e.infowindow+'<IMG BORDER="0" ALIGN="Left" SRC="https://s3.amazonaws.com/deis-dorms-devel/pictures/static/buildings/'+e.id+'.jpg" SIZE="175x131" height="131" width="175"></p><a href="/quads/'+e.quad_id+"/buildings/"+e.id+'" type="button" class="btn btn-primary">Learn More</a>',a=new google.maps.InfoWindow({content:n});return a}function createSidebar(e){initialized=!0,_.each(e,function(e){var n=$("<div class='pointer'>"+e.name+"</div>");n.appendTo("#sidebar_container"),n.on("click",function(){createForSideBar(e)})})}function createForSideBar(e){controlMarkers(markers,ifKeep),null===ifKeep&&(markers=[]);var n=create(e);n.setMap(map),map.panTo({lat:e.lat,lng:e.lng}),markers.push(n)}function controlMarkers(e,n){for(var a=0;a<e.length;a++)e[a].setMap(n)}function create(e){var n=createInfowindow(e),a={lat:e.lat,lng:e.lng},t=new google.maps.Marker({position:a,animation:google.maps.Animation.DROP,map:map});return t.addListener("click",function(){n.open(map,t)}),t}function create_interest_marker(e){for(var n=0;n<e.length;n++){var a={lat:e[n].lat,lng:e[n].lng},t=brandeis_logo;"Starbucks"===e[n].name?t=starbucks:"Einstein Bros Bagels"===e[n].name?t=einstein:"Dunkin' Donuts"===e[n].name&&(t=donut);var o=new google.maps.Marker({position:a,map:map,icon:t});interest_markers.push(o)}firstTime=!1}function show(e){firstTime&&create_interest_marker(e),controlMarkers(interest_markers,map);for(var n=0;n<interest_markers.length;n++){var a=interest_markers[n];a.setAnimation(google.maps.Animation.BOUNCE),stopAnimation(a)}map.panTo({lat:42.366719,lng:-71.258604})}function stopAnimation(e){setTimeout(function(){e.setAnimation(null)},1420)}function hide(){controlMarkers(interest_markers,null)}function keepMarkers(e){e.checked?ifKeep=map:(ifKeep=null,controlMarkers(markers,ifKeep),markers=[])}function interestMarkersBox(e){e.checked?show(places_of_interest):hide(places_of_interest)}var json_array=gon.buildings,places_of_interest=[{lat:42.363196,lng:-71.260464,name:"Dunkin' Donuts",infowindow:"food info and shop info"},{lat:42.367854,lng:-71.258671,name:"Starbucks",infowindow:"Starbucks in Farber Library"},{lat:42.36573,lng:-71.260188,name:"Einstein Bros Bagels",infowindow:"Selling bagels and softdrinks here"},{lat:42.368043,lng:-71.256617,name:"Usdan Dinning Hall",infowindow:"Lower Usdan Dinning hall"},{lat:42.366412,lng:-71.260546,name:"Sherman Dinning Hall",infowindow:"Student dinning hall"}],markers=[],brandeis_logo="https://s3.amazonaws.com/deis-dorms-devel/pictures/static/map_icons/brandeis_logo.png",starbucks="https://s3.amazonaws.com/deis-dorms-devel/pictures/static/map_icons/s_logo.png",donut="https://s3.amazonaws.com/deis-dorms-devel/pictures/static/map_icons/d_logo.png",einstein="https://s3.amazonaws.com/deis-dorms-devel/pictures/static/map_icons/e_logo.png",map,geojsonData;$.ajax({url:"/geodata",success:function(e){geojsonData=e}});var ifKeep=null,kids;$("#search").on("input",function(){kids=$("#sidebar_container div");for(var e=$("#search").val().toLowerCase(),n=0;n<kids.length;n++){var a=-1!==kids[n].textContent.toLowerCase().indexOf(e);kids[n].style.display=a?"block":"none"}}),$("body > #sidebar_container").remove();var interest_markers=[],firstTime=!0;